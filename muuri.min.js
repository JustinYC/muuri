/*!
 * Muuri v0.5.4
 * https://github.com/haltu/muuri
 * Copyright (c) 2015, Haltu Oy
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
/*!
 * muuriLayout v0.5.4
 * Copyright (c) 2016 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license
 */
!function(t,e){var i,n="Muuri";if("object"==typeof module&&module.exports){try{i=require("hammerjs")}catch(t){}module.exports=e(n,i)}else"function"==typeof define&&define.amd?define(["hammerjs"],function(t){return e(n,t)}):t[n]=e(n,t.Hammer)}("undefined"!=typeof window?window:this,function(t,e,i){"use strict";var n,r,o=window,s=o.Object,a=o.Array,l=o.Math,d=o.Error,h=o.Element,f=o.document,u=f.documentElement,_=f.body,c="function",g="string",m="number",p=function(){var t=null,e=[],n={},r=(o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||o.msRequestAnimationFrame||function(t){return o.setTimeout(t,16)}).bind(o);function s(){var o,a=+B._maxRafBatchSize||100,d=e.splice(0,l.min(a,e.length)),h={};for(t=null,o=0;o<d.length;o++)h[d[o]]=n[d[o]],n[d[o]]=i;for(o=0;o<d.length;o++)h[d[o]][0]();for(o=0;o<d.length;o++)h[d[o]][1]();!t&&e.length&&(t=r(s))}return{add:function(i,o,a,l){var d=e.indexOf(i+o);d>-1&&e.splice(d,1);i===D||i===w?e.unshift(i+o):e.push(i+o),n[i+o]=[a,l],!t&&(t=r(s))},cancel:function(t,r){var o=e.indexOf(t+r);o>-1&&(e.splice(o,1),n[t+r]=i)}}}(),y="layout",v="visibility",D="move",w="scroll",S=0,I=1,C=2,b=3,A={},x={},H=function(){},E=0,R=(n=h.prototype,r=n.matches||n.matchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector,function(t,e){return r.call(t,e)}),P=function(t){var e,n,r,o=t.charAt(0).toUpperCase()+t.slice(1),s=["","Webkit","Moz","O","ms"];for(r=0;r<s.length;r++)if(n=(e=s[r])?e+o:t,u.style[n]!==i)return{prefix:e=e.toLowerCase(),propName:n,styleName:e?"-"+e+"-"+t:t};return null}("transform"),L=_?pt():null,G="layoutEnd",X="showStart",Y="showEnd",O="hideStart",N="hideEnd",k="move",T="send",M="beforeSend",z="receive",F="beforeReceive";function B(t,e){var i,n,r,s,l,h,u=this;if(_||(_=document.body,L=pt()),t=u._element=typeof t===g?f.querySelector(t):t,!_.contains(t))throw new d("Container element must be an existing DOM element");typeof(i=u._settings=(l=e,h=et({},s=B.defaultOptions),(h=l?et(h,l):h).visibleStyles=(l||{}).visibleStyles||(s||{}).visibleStyles,h.hiddenStyles=(l||{}).hiddenStyles||(s||{}).hiddenStyles,h)).dragSort!==c&&(i.dragSort=!!i.dragSort),A[u._id=++E]=u,u._isDestroyed=!1,u._layout=null,u._emitter=new B.Emitter,u._itemShowHandler=It("show",i),u._itemHideHandler=It("hide",i),ht(t,i.containerClass),u._items=[],typeof(n=i.items)===g?ut(u._element.children).forEach(function(t){("*"===n||R(t,n))&&u._items.push(new B.Item(u,t))}):(a.isArray(n)||tt(n))&&(u._items=ut(n).map(function(t){return new B.Item(u,t)})),(r=!0===(r=i.layoutOnResize)?0:typeof r===m?r:-1)>=0&&o.addEventListener("resize",u._resizeHandler=nt(function(){u.refreshItems().layout()},r)),i.layoutOnInit&&u.layout(!0)}function V(t,e){var i,n=this,r=t._settings;n._id=++E,x[n._id]=n,n._isDestroyed=!1,e.parentNode!==t._element&&t._element.appendChild(e),ht(e,r.itemClass),ht(e,(i="none"===rt(e,"display"))?r.itemHiddenClass:r.itemVisibleClass),n._gridId=t._id,n._element=e,n._child=e.children[0],n._animate=new B.ItemAnimate(n,e),n._animateChild=new B.ItemAnimate(n,n._child),n._isActive=!i,n._isPositioning=!1,n._isHidden=i,n._isHiding=!1,n._isShowing=!1,n._visibilityQueue=[],n._layoutQueue=[],n._left=0,n._top=0,dt(e,{left:"0",top:"0",transform:at(0,0),display:i?"none":"block"}),n._refreshDimensions()._refreshSortData(),i?t._itemHideHandler.start(n,!0):t._itemShowHandler.start(n,!0),n._migrate=new B.ItemMigrate(n),n._release=new B.ItemRelease(n),n._drag=r.dragEnabled?new B.ItemDrag(n):null}function Q(){this._events={},this._eventNames=[],this._mutations=[],this._isProcessing=!1,this._isDestroyed=!1}function j(t,e){var i=this;i._item=t,i._element=e,i._animation=null,i._propsTo=null,i._isDestroyed=!1}function W(t){var e=this;e._itemId=t._id,e._isDestroyed=!1,e.isActive=!1,e.container=!1,e.containerDiffX=0,e.containerDiffY=0}function q(t){var e=this;e._itemId=t._id,e._isDestroyed=!1,e.isActive=!1,e.isPositioningStarted=!1,e.containerDiffX=0,e.containerDiffY=0}function U(i){if(!e)throw new d("["+t+"] required dependency Hammer is not defined.");var n,r,o=this,s=i._element,a=i.getGrid(),l=a._settings,h=typeof l.dragStartPredicate===c?l.dragStartPredicate:U.defaultStartPredicate,f=S;o._itemId=i._id,o._gridId=a._id,o._hammer=n=new e.Manager(s),o._isDestroyed=!1,o._isMigrating=!1,o._data={},o._resolveStartPredicate=function(t){o._isDestroyed||f!==I||(f=C,o.onStart(t))},o._scrollListener=function(t){o.onScroll(t)},o._checkSortOverlap=nt(function(){o._data.isActive&&o.checkOverlap()},l.dragSortInterval),o._sortPredicate=typeof l.dragSortPredicate===c?l.dragSortPredicate:U.defaultSortPredicate,o.reset(),n.add(new e.Pan({event:"drag",pointers:1,threshold:0,direction:e.DIRECTION_ALL})),n.add(new e.Press({event:"draginit",pointers:1,threshold:1e3,time:0})),K(l.dragHammerSettings)&&n.set(l.dragHammerSettings),n.on("draginit dragstart dragmove",function(t){f===S&&(f=I),f===I?!0===(r=h(o.getItem(),t))?(f=C,o.onStart(t)):!1===r&&(f=b):f===C&&o._data.isActive&&o.onMove(t)}).on("dragend dragcancel draginitup",function(t){var e=f===C;h(o.getItem(),t),f=S,e&&o._data.isActive&&o.onEnd(t)}),s.addEventListener("dragstart",At,!1)}function Z(t,e,i){var n=t.length,r=l.max(0,i?n:n-1);return e>r?r:e<0?l.max(r+e+1,0):e}function $(t,e,i){if(!(t.length<2)){var n,r=Z(t,e),o=Z(t,i);r!==o&&(n=t[r],t[r]=t[o],t[o]=n)}}function J(t,e,i){if(!(t.length<2)){var n=Z(t,e),r=Z(t,i);n!==r&&t.splice(r,0,t.splice(n,1)[0])}}function K(t){return"object"==typeof t&&"[object Object]"===s.prototype.toString.call(t)}function tt(t){var e=s.prototype.toString.call(t);return"[object HTMLCollection]"===e||"[object NodeList]"===e}function et(t,e){return s.keys(e).forEach(function(i){var n=K(e[i]);K(t[i])&&n?(t[i]=et({},t[i]),t[i]=et(t[i],e[i])):t[i]=n?et({},e[i]):a.isArray(e[i])?e[i].concat():e[i]}),t}function it(t,e,i){var n=typeof i===m?i:-1;t.splice.apply(t,[n<0?t.length-n+1:n,0].concat(e))}function nt(t,e){var n;return e>0?function(r){n!==i&&(n=o.clearTimeout(n),"finish"===r&&t()),"cancel"!==r&&"finish"!==r&&(n=o.setTimeout(function(){n=i,t()},e))}:function(e){"cancel"!==e&&t()}}function rt(t,e){return o.getComputedStyle(t,null).getPropertyValue("transform"===e&&P.styleName||e)}function ot(t,e){return parseFloat(rt(t,e))||0}function st(t,e){return parseFloat((rt(t,"transform")||"").replace("matrix(","").split(",")["x"===e?4:5])||0}function at(t,e){return"translateX("+t+"px) translateY("+e+"px)"}function lt(t,e){var i,n={},r=s.keys(e);for(i=0;i<r.length;i++)n[r[i]]=rt(t,r[i].replace(/([A-Z])/g,"-$1").toLowerCase());return n}function dt(t,e){var i,n=s.keys(e);for(i=0;i<n.length;i++)t.style["transform"===n[i]&&P?P.propName:n[i]]=e[n[i]]}function ht(t,e){t.classList?t.classList.add(e):R(t,"."+e)||(t.className+=" "+e)}function ft(t,e){t.classList?t.classList.remove(e):R(t,"."+e)&&(t.className=(" "+t.className+" ").replace(" "+e+" "," ").trim())}function ut(t){return[].slice.call(t)}function _t(t,e,i){if(t===e)return{left:0,top:0};i&&(t=gt(t,!0),e=gt(e,!0));var n=ct(t,!0),r=ct(e,!0);return{left:r.left-n.left,top:r.top-n.top}}function ct(t,e){var i,n={left:0,top:0};return t===f?n:(n.left=o.pageXOffset||0,n.top=o.pageYOffset||0,t.self===o.self?n:(i=t.getBoundingClientRect(),n.left+=i.left,n.top+=i.top,e&&(n.left+=ot(t,"border-left-width"),n.top+=ot(t,"border-top-width")),n))}function gt(t,e){for(var i=(e?t:t.parentElement)||f;i&&i!==f&&"static"===rt(i,"position")&&!yt(i);)i=i.parentElement||f;return i}function mt(t){var e=[],i=/(auto|scroll)/,n=t.parentNode;if(L){if("fixed"===rt(t,"position"))return e;for(;n&&n!==f&&n!==u;)i.test(rt(n,"overflow")+rt(n,"overflow-y")+rt(n,"overflow-x"))&&e.push(n),n="fixed"===rt(n,"position")?null:n.parentNode;null!==n&&e.push(o)}else{for(;n&&n!==f;)"fixed"!==rt(t,"position")||yt(n)?(i.test(rt(n,"overflow")+rt(n,"overflow-y")+rt(n,"overflow-x"))&&e.push(n),t=n,n=n.parentNode):n=n.parentNode;e[e.length-1]===u?e[e.length-1]=o:e.push(o)}return e}function pt(){if(!P)return!0;var t=[0,1].map(function(t,e){return dt(t=f.createElement("div"),{position:e?"fixed":"absolute",display:"block",visibility:"hidden",left:e?"0px":"1px",transform:"none"}),t}),e=_.appendChild(t[0]),i=e.appendChild(t[1]),n=i.getBoundingClientRect().left;dt(e,{transform:"scale(1)"});var r=n===i.getBoundingClientRect().left;return _.removeChild(e),r}function yt(t){var e=rt(t,"transform"),i=rt(t,"display");return"none"!==e&&"inline"!==i&&"none"!==i}function vt(t,e){return Et.doRectsOverlap(t,e)?(l.min(t.left+t.width,e.left+e.width)-l.max(t.left,e.left))*(l.min(t.top+t.height,e.top+e.height)-l.max(t.top,e.top))/(l.min(t.width,e.width)*l.min(t.height,e.height))*100:0}function Dt(t){var e,i={};for(e=0;e<t.length;e++)i[t[e]._id]=e;return i}function wt(t,e,i,n){var r=n[t._id],o=n[e._id];return i?o-r:r-o}function St(t,e,n,r){var o,s,a=t.getItems(n),l=r||{},d=!0===l.instant,h=l.onFinish,f=l.layout?l.layout:l.layout===i,u=a.length,_="show"===e,g=_?X:O,m=_?Y:N,p=!1,y=[],v=[];if(u){for(t._emit(g,a.concat()),s=0;s<a.length;s++)o=a[s],(_&&!o._isActive||!_&&o._isActive)&&(p=!0),_&&!o._isActive&&(o._skipNextLayoutAnimation=!0),_&&o._isHidden&&v.push(o),o["_"+e](d,function(e,i){e||y.push(i),--u<1&&(typeof h===c&&h(y.concat()),t._emit(m,y.concat()))});v.length&&t.refreshItems(v),p&&f&&t.layout("instant"===f,typeof f===c?f:i)}else typeof h===c&&h(a);return t}function It(t,e){var i,n="show"===t,r=parseInt(n?e.showDuration:e.hideDuration)||0,o=(n?e.showEasing:e.hideEasing)||"ease",s=n?e.visibleStyles:e.hiddenStyles,a=r>0;return s=K(s)?s:null,{start:function(t,e,n){s?(p.cancel(v,t._id),!a||e?(t._animateChild.isAnimating()?t._animateChild.stop(s):dt(t._child,s),n&&n()):p.add(v,t._id,function(){i=lt(t._child,s)},function(){t._animateChild.start(i,s,{duration:r,easing:o,onFinish:n})})):n&&n()},stop:function(t,e){p.cancel(v,t._id),t._animateChild.stop(e)}}}function Ct(t,e,i){var n,r=t.splice(0,t.length);for(n=0;n<r.length;n++)r[n](e,i)}function bt(t,e){var i;return"inactive"===e?!t.isActive():"hidden"===e?!t.isVisible():typeof t[i="is"+e.charAt(0).toUpperCase()+e.slice(1)]===c&&t[i]()}function At(t){t.preventDefault&&t.preventDefault()}function xt(t,e){var i,n,r,s,a=t._drag._startPredicateData,l=e.changedPointers[0],d=l&&l.pageX||0,h=l&&l.pageY||0;if(!(e.distance<a.distance||a.delay))return i=a.handleElement.getBoundingClientRect(),Ht(t),n=d,r=h,(s={width:i.width,height:i.height,left:i.left+(o.pageXOffset||0),top:i.top+(o.pageYOffset||0)}).width&&s.height&&n>=s.left&&n<s.left+s.width&&r>=s.top&&r<s.top+s.height}function Ht(t){var e=t._drag._startPredicateData;e&&(e.delayTimer&&(e.delayTimer=o.clearTimeout(e.delayTimer)),t._drag._startPredicateData=null)}function Et(t,e,i,n){var r,o,a,d,h,f,u,_=!!n.fillGaps,c=!!n.horizontal,g=!!n.alignRight,m=!!n.alignBottom,p=!!n.rounding,y={slots:{},width:c?0:p?l.round(e):e,height:c?p?l.round(i):i:0,setWidth:c,setHeight:!c},v=[];if(!t.length)return y;for(u=0;u<t.length;u++)h=(d=t[u])._width+d._margin.left+d._margin.right,f=d._height+d._margin.top+d._margin.bottom,p&&(h=l.round(h),f=l.round(f)),a=(o=Et.getSlot(y,v,h,f,!c,_))[0],v=o[1],c?y.width=l.max(y.width,a.left+a.width):y.height=l.max(y.height,a.top+a.height),y.slots[d._id]=a;if(g||m)for(r=s.keys(y.slots),u=0;u<r.length;u++)a=y.slots[r[u]],g&&(a.left=y.width-(a.left+a.width)),m&&(a.top=y.height-(a.top+a.height));return y}return B.Item=V,B.ItemDrag=U,B.ItemRelease=q,B.ItemMigrate=W,B.ItemAnimate=j,B.Layout=function(t,e){var i=this,n=t._settings.layout;e=e.concat(),t._refreshDimensions();var r=t._width-t._border.left-t._border.right,o=t._height-t._border.top-t._border.bottom,s=typeof n===c?n(e,r,o):Et(e,r,o,K(n)?n:{});i.slots=s.slots,i.setWidth=s.setWidth||!1,i.setHeight=s.setHeight||!1,i.width=s.width,i.height=s.height},B.Emitter=Q,B.defaultOptions={items:"*",showDuration:300,showEasing:"ease",hideDuration:300,hideEasing:"ease",visibleStyles:{opacity:"1",transform:"scale(1)"},hiddenStyles:{opacity:"0",transform:"scale(0.5)"},layout:{fillGaps:!1,horizontal:!1,alignRight:!1,alignBottom:!1,rounding:!0},layoutOnResize:100,layoutOnInit:!0,layoutDuration:300,layoutEasing:"ease",sortData:null,dragEnabled:!1,dragContainer:null,dragStartPredicate:{distance:0,delay:0,handle:!1},dragAxis:null,dragSort:!0,dragSortInterval:100,dragSortPredicate:{threshold:50,action:"move"},dragReleaseDuration:300,dragReleaseEasing:"ease",dragHammerSettings:{touchAction:"none"},containerClass:"muuri",itemClass:"muuri-item",itemVisibleClass:"muuri-item-shown",itemHiddenClass:"muuri-item-hidden",itemPositioningClass:"muuri-item-positioning",itemDraggingClass:"muuri-item-dragging",itemReleasingClass:"muuri-item-releasing"},B._maxRafBatchSize=100,B.prototype.on=function(t,e){return this._isDestroyed||this._emitter.on(t,e),this},B.prototype.once=function(t,e){return this._isDestroyed||this._emitter.once(t,e),this},B.prototype.off=function(t,e){return this._isDestroyed||this._emitter.off(t,e),this},B.prototype.getElement=function(){return this._element},B.prototype.getItems=function(t,e){if(this._isDestroyed)return[];var i,n,r=0===t||t&&typeof t!==g,o=r?tt(t)?ut(t):[].concat(t):null,s=r?e:t,a=[];if((s=typeof s===g?s:null)||o){for(o=o||this._items,n=0;n<o.length;n++)!(i=r?this._getItem(o[n]):o[n])||s&&!bt(i,s)||a.push(i);return a}return a.concat(this._items)},B.prototype.refreshItems=function(t){if(this._isDestroyed)return this;var e,i=this.getItems(t||"active");for(e=0;e<i.length;e++)i[e]._refreshDimensions();return this},B.prototype.refreshSortData=function(t){if(this._isDestroyed)return this;var e,i=this.getItems(t);for(e=0;e<i.length;e++)i[e]._refreshSortData();return this},B.prototype.synchronize=function(){var t=this;if(t._isDestroyed)return t;var e,i,n,r=t._element,o=t._items;if(o.length){for(n=0;n<o.length;n++)(i=o[n]._element).parentNode===r&&(e=e||f.createDocumentFragment()).appendChild(i);e&&r.appendChild(e)}return t._emit("synchronize"),t},B.prototype.layout=function(t,e){var i=this;if(i._isDestroyed)return i;var n,r,o,s,a,l=typeof t===c?t:e,d=!0===t,h=i.getItems("active"),f=i._layout=new B.Layout(i,h),u=h.length;function _(){--u<=0&&(typeof l===c&&l(i._layout!==f,h.concat()),i._layout===f&&i._emit(G,h.concat()))}if((f.setWidth||f.setHeight)&&(r={},n="border-box"===rt(i._element,"box-sizing"),f.setHeight&&(typeof f.height===m?r.height=(n?f.height+i._border.top+i._border.bottom:f.height)+"px":r.height=f.height),f.setWidth&&(typeof f.width===m?r.width=(n?f.width+i._border.left+i._border.right:f.width)+"px":r.width=f.width),dt(i._element,r)),i._emit("layoutStart",h.concat()),!h.length)return _(),i;for(a=0;a<h.length;a++)o=h[a],s=f.slots[o._id],o._left=s.left,o._top=s.top,o.isDragging()?_():o._layout(d,_);return i},B.prototype.add=function(t,e){var n=this;if(n._isDestroyed)return[];var r=tt(t)?ut(t):[].concat(t),o=[];if(!r.length)return o;var s,a,l,d=e||{},h=d.layout?d.layout:d.layout===i,f=n._items,u=!1;for(l=0;l<f.length;l++)if((s=r.indexOf(f[l]._element))>-1&&(r.splice(s,1),!r.length))return o;for(l=0;l<r.length;l++)a=new B.Item(n,r[l]),o.push(a),a._isActive&&(u=!0,a._skipNextLayoutAnimation=!0);return it(f,o,d.index),n._emit("add",o.concat()),u&&h&&n.layout("instant"===h,typeof h===c?h:i),o},B.prototype.remove=function(t,e){var n=this;if(n._isDestroyed)return n;var r,o,s=e||{},a=s.layout?s.layout:s.layout===i,l=!1,d=n.getItems(),h=n.getItems(t),f=[];for(o=0;o<h.length;o++)r=h[o],f.push(d.indexOf(r)),r._isActive&&(l=!0),r._destroy(s.removeElements);return n._emit("remove",h.concat(),f),l&&a&&n.layout("instant"===a,typeof a===c?a:i),h},B.prototype.show=function(t,e){return this._isDestroyed?this:St(this,"show",t,e)},B.prototype.hide=function(t,e){return this._isDestroyed?this:St(this,"hide",t,e)},B.prototype.filter=function(t,e){var n=this;if(n._isDestroyed||!n._items.length)return n;var r,o,s=n._items,a=typeof t,l=a===g,d=a===c,h=e||{},f=!0===h.instant,u=h.layout?h.layout:h.layout===i,_=typeof h.onFinish===c?h.onFinish:null,m=[],p=[],y=-1,v=_?function(){++y&&_(m.concat(),p.concat())}:H;if(d||l)for(o=0;o<s.length;o++)r=s[o],(d?t(r):R(r._element,t))?m.push(r):p.push(r);return m.length?n.show(m,{instant:f,onFinish:v,layout:!1}):v(),p.length?n.hide(p,{instant:f,onFinish:v,layout:!1}):v(),(m.length||p.length)&&(n._emit("filter",m.concat(),p.concat()),u&&n.layout("instant"===u,typeof u===c?u:i)),n},B.prototype.sort=function(t,e){var n=this;if(n._isDestroyed||n._items.length<2)return n;var r,o=n._items,s=e||{},l=!!s.descending,d=s.layout?s.layout:s.layout===i,h=o.concat();if(typeof t===c)o.sort(function(e,i){var n=t(e,i);return(l&&0!==n?-n:n)||wt(e,i,l,r||(r=Dt(h)))});else if(typeof t===g)t=t.trim().split(" ").map(function(t){return t.split(":")}),o.sort(function(e,i){return function(t,e,i,n){var r,o,s,a,l,d=0;for(l=0;l<n.length;l++)if(r=n[l][0],o=n[l][1],s=(t._sortData?t:t._refreshSortData())._sortData[r],a=(e._sortData?e:e._refreshSortData())._sortData[r],0!==(d="desc"===o||!o&&i?a<s?-1:a>s?1:0:s<a?-1:s>a?1:0))return d;return d}(e,i,l,t)||wt(e,i,l,r||(r=Dt(h)))});else{if(!a.isArray(t))return n;!function(t,e){var i,n,r,o=[],s=t.concat();for(r=0;r<e.length;r++)i=e[r],(n=s.indexOf(i))>-1&&(o.push(i),s.splice(n,1));t.splice.apply(t,[0,t.length].concat(o).concat(s))}(o,t),l&&o.reverse()}return n._emit("sort",o.concat(),h),d&&n.layout("instant"===d,typeof d===c?d:i),n},B.prototype.move=function(t,e,n){var r=this;if(r._isDestroyed||r._items.length<2)return r;var o,s,a=r._items,l=n||{},d=l.layout?l.layout:l.layout===i,h="swap"===l.action,f=h?"swap":"move",u=r._getItem(t),_=r._getItem(e);return u&&_&&u!==_&&((h?$:J)(a,o=a.indexOf(u),s=a.indexOf(_)),r._emit(k,{item:u,fromIndex:o,toIndex:s,action:f}),d&&r.layout("instant"===d,typeof d===c?d:i)),r},B.prototype.send=function(t,e,n,r){var o=this;if(o._isDestroyed||e._isDestroyed||o===e||!(t=o._getItem(t)))return o;var s=e,a=r||{},l=a.appendTo||_,d=a.layoutSender?a.layoutSender:a.layoutSender===i,h=a.layoutReceiver?a.layoutReceiver:a.layoutReceiver===i;return t._migrate.start(s,n,l),t._migrate.isActive&&t.isActive()&&(d&&o.layout("instant"===d,typeof d===c?d:i),h&&s.layout("instant"===h,typeof h===c?h:i)),o},B.prototype.destroy=function(t){var e=this;if(e._isDestroyed)return e;var n,r=e._element,s=e._items.concat();for(e._resizeHandler&&o.removeEventListener("resize",e._resizeHandler),n=0;n<s.length;n++)s[n]._destroy(t);return ft(r,e._settings.containerClass),dt(r,{height:""}),e._emit("destroy"),e._emitter.destroy(),A[e._id]=i,e._isDestroyed=!0,e},B.prototype._getItem=function(t){var e,i=this._items;if(this._isDestroyed||!t)return i[0]||null;if(typeof t===m)return i[t>-1?t:i.length+t]||null;if(t instanceof V)return t._gridId===this._id?t:null;for(e=0;e<i.length;e++)if(i[e]._element===t)return i[e];return null},B.prototype._emit=function(){return this._isDestroyed||this._emitter.emit.apply(this._emitter,arguments),this},B.prototype._refreshDimensions=function(){var t,e=this,i=e._element,n=i.getBoundingClientRect(),r=["left","right","top","bottom"];for(e._width=n.width,e._height=n.height,e._left=n.left,e._top=n.top,e._border={},t=0;t<r.length;t++)e._border[r[t]]=ot(i,"border-"+r[t]+"-width");return e},V.prototype.getGrid=function(){return A[this._gridId]},V.prototype.getElement=function(){return this._element},V.prototype.getWidth=function(){return this._width},V.prototype.getHeight=function(){return this._height},V.prototype.getMargin=function(){return{left:this._margin.left,right:this._margin.right,top:this._margin.top,bottom:this._margin.bottom}},V.prototype.getPosition=function(){return{left:this._left,top:this._top}},V.prototype.isActive=function(){return this._isActive},V.prototype.isVisible=function(){return!this._isHidden},V.prototype.isShowing=function(){return this._isShowing},V.prototype.isHiding=function(){return this._isHiding},V.prototype.isPositioning=function(){return this._isPositioning},V.prototype.isDragging=function(){return!!this._drag&&this._drag._data.isActive},V.prototype.isReleasing=function(){return this._release.isActive},V.prototype.isDestroyed=function(){return this._isDestroyed},V.prototype._refreshDimensions=function(){var t=this;if(t._isDestroyed||t._isHidden)return t;var e,i,n=t._element,r=n.getBoundingClientRect(),o=["left","right","top","bottom"],s=t._margin=t._margin||{};for(t._width=r.width,t._height=r.height,i=0;i<4;i++)e=ot(n,"margin-"+o[i]),s[o[i]]=e>0?e:0;return t},V.prototype._refreshSortData=function(){var t=this;if(t._isDestroyed)return t;var e={},i=t.getGrid()._settings.sortData;return i&&s.keys(i).forEach(function(n){e[n]=i[n](t,t._element)}),t._sortData=e,t},V.prototype._layout=function(t,e){var i=this;if(i._isDestroyed)return i;var n,r,o,s,a,l,d=i._element,h=i._isPositioning,f=i._migrate,u=i._release,_=u.isActive&&!1===u.isPositioningStarted,g=i.getGrid()._settings,m=_?g.dragReleaseDuration:g.layoutDuration,v=_?g.dragReleaseEasing:g.layoutEasing,D=!t&&!i._skipNextLayoutAnimation&&m>0;return h&&Ct(i._layoutQueue,!0,i),_&&(u.isPositioningStarted=!0),typeof e===c&&i._layoutQueue.push(e),r=u.isActive?u.containerDiffX:f.isActive?f.containerDiffX:0,o=u.isActive?u.containerDiffY:f.isActive?f.containerDiffY:0,l={transform:at(i._left+r,i._top+o)},D?(i._isPositioning=!0,p.add(y,i._id,function(){s=st(d,"x")-r,a=st(d,"y")-o},function(){if(i._left===s&&i._top===a)return h&&i._stopLayout(!1,l),i._isPositioning=!1,i._finishLayout();!h&&ht(d,g.itemPositioningClass),i._animate.start({transform:at(s+r,a+o)},l,{duration:m,easing:v,onFinish:function(){i._finishLayout()}})}),i):(h&&p.cancel(y,i._id),n=i._animate.isAnimating(),i._stopLayout(!1,l),!n&&dt(d,l),i._skipNextLayoutAnimation=!1,i._finishLayout())},V.prototype._finishLayout=function(){var t=this;return t._isDestroyed?t:(t._isPositioning&&(t._isPositioning=!1,ft(t._element,t.getGrid()._settings.itemPositioningClass)),t._release.isActive&&t._release.stop(),t._migrate.isActive&&t._migrate.stop(),Ct(t._layoutQueue,!1,t),t)},V.prototype._stopLayout=function(t,e){var i=this;return i._isDestroyed||!i._isPositioning?i:(p.cancel(y,i._id),i._animate.stop(e),ft(i._element,i.getGrid()._settings.itemPositioningClass),i._isPositioning=!1,t&&Ct(i._layoutQueue,!0,i),i)},V.prototype._show=function(t,e){var i=this;if(i._isDestroyed)return i;var n=i._element,r=i._visibilityQueue,o=typeof e===c?e:null,s=i.getGrid(),a=s._settings;return i._isShowing||i._isHidden?i._isShowing&&!t?(o&&r.push(o),i):(i._isShowing||(Ct(r,!0,i),ft(n,a.itemHiddenClass),ht(n,a.itemVisibleClass),!i._isHiding&&dt(n,{display:"block"})),o&&r.push(o),i._isActive=i._isShowing=!0,i._isHiding=i._isHidden=!1,t?(s._itemShowHandler.stop(i,a.visibleStyles),i._isShowing=!1,Ct(r,!1,i)):s._itemShowHandler.start(i,t,function(){i._isHidden||(i._isShowing=!1,Ct(r,!1,i))}),i):(o&&o(!1,i),i)},V.prototype._hide=function(t,e){var i=this;if(i._isDestroyed)return i;var n=i._element,r=i._visibilityQueue,o=typeof e===c?e:null,s=i.getGrid(),a=s._settings;return!i._isHiding&&i._isHidden?(o&&o(!1,i),i):i._isHiding&&!t?(o&&r.push(o),i):(i._isHiding||(Ct(r,!0,i),ht(n,a.itemHiddenClass),ft(n,a.itemVisibleClass)),o&&r.push(o),i._isHidden=i._isHiding=!0,i._isActive=i._isShowing=!1,t?(s._itemHideHandler.stop(i,a.hiddenStyles),i._isHiding=!1,i._stopLayout(!0,{transform:at(0,0)}),dt(n,{display:"none"}),Ct(r,!1,i)):s._itemHideHandler.start(i,t,function(){i._isHidden&&(i._isHiding=!1,i._stopLayout(!0,{transform:at(0,0)}),dt(n,{display:"none"}),Ct(r,!1,i))}),i)},V.prototype._destroy=function(t){var e=this;if(e._isDestroyed)return e;var n=e._element,r=e.getGrid(),o=r._settings,s=r._items.indexOf(e);return e._release.destroy(),e._migrate.destroy(),e._stopLayout(!0,{}),r._itemShowHandler.stop(e,{}),r._itemHideHandler.stop(e,{}),e._drag&&e._drag.destroy(),e._animate.destroy(),e._animateChild.destroy(),Ct(e._visibilityQueue,!0,e),n.removeAttribute("style"),e._child.removeAttribute("style"),ft(n,o.itemPositioningClass),ft(n,o.itemDraggingClass),ft(n,o.itemReleasingClass),ft(n,o.itemClass),ft(n,o.itemVisibleClass),ft(n,o.itemHiddenClass),s>-1&&r._items.splice(s,1),t&&n.parentNode.removeChild(n),x[e._id]=i,e._isActive=e._isPositioning=e._isHiding=e._isShowing=!1,e._isDestroyed=e._isHidden=!0,e},Q.prototype.on=function(t,e){if(this._isDestroyed)return this;if(this._isProcessing===t)return this._mutations.push("on",e),this;var i=this._events[t];return i||(i=this._events[t]=[],this._eventNames.push(t)),i.push(e),this},Q.prototype.once=function(t,e){var i=this;return this.on(t,function n(){i.off(t,n),e.apply(null,arguments)})},Q.prototype.off=function(t,e){if(this._isDestroyed)return this;if(this._isProcessing===t)return this._mutations.push("off",e),this;var i=this._events[t];if(!i||!i.length)return this;for(var n=i.length;n--;)e===i[n]&&i.splice(n,1);return this},Q.prototype.emit=function(t,e,i,n){var r=this._events[t];if(this._isDestroyed||!r||!r.length)return this;var o,s=arguments.length-1;for(this._isProcessing=t,o=0;o<r.length;o++)0===s?r[o]():1===s?r[o](e):2===s?r[o](e,i):r[o](e,i,n);if(this._isProcessing=!1,!this._mutations.length)return this;for(o=0;o<this._mutations.length;o+=2)this[this._mutations[o]](t,this._mutations[o+1]);return this._mutations.length=0,this},Q.prototype.destroy=function(){if(this._isDestroyed)return this;this._isDestroyed=!0;for(var t=0;t<this._eventNames.length;t++)this._events[this._eventNames[t]]=i;return this._eventNames.length=0,this._mutations.length=0,this},j.prototype.start=function(t,e,i){var n=this;if(!n._isDestroyed){var r=i||{},o=typeof r.onFinish===c?r.onFinish:null;if(n._animation){if(!s.keys(e).some(function(t){return e[t]!==n._propsTo[t]}))return void(n._animation.onfinish=function(){n._animation=n._propsTo=null,o&&o()});n._animation.cancel()}n._propsTo=e,n._animation=n._element.animate([t,e],{duration:r.duration||300,easing:r.easing||"ease"}),n._animation.onfinish=function(){n._animation=n._propsTo=null,o&&o()},dt(n._element,e)}},j.prototype.stop=function(t){var e=this;!e._isDestroyed&&e._animation&&(dt(e._element,t||lt(e._element,e._propsTo)),e._animation.cancel(),e._animation=e._propsTo=null)},j.prototype.isAnimating=function(){return!!this._animation},j.prototype.destroy=function(){var t=this;t._isDestroyed||(t.stop(),t._item=t._element=null,t._isDestroyed=!0)},W.prototype.destroy=function(){return this._isDestroyed||(this.stop(!0),this._isDestroyed=!0),this},W.prototype.getItem=function(){return x[this._itemId]||null},W.prototype.start=function(t,e,n){var r=this;if(r._isDestroyed)return r;var o,s,a,l,d,h=r.getItem(),f=h._element,u=h.isVisible(),c=h.getGrid(),g=c._settings,p=t._settings,y=t._element,v=c._items.indexOf(h),D=typeof e===m?e:t._items.indexOf(t._getItem(e)),w=n||_;return null===D?r:(D=Z(t._items,D,!0),(h.isPositioning()||r.isActive||h.isReleasing())&&(l=st(f,"x"),d=st(f,"y")),h.isPositioning()&&h._stopLayout(!0,{transform:at(l,d)}),r.isActive&&(l-=r.containerDiffX,d-=r.containerDiffY,r.stop(!0,{transform:at(l,d)})),h.isReleasing()&&(l-=h._release.containerDiffX,d-=h._release.containerDiffY,h._release.stop(!0,{transform:at(l,d)})),c._itemShowHandler.stop(h),c._itemHideHandler.stop(h),h._drag&&h._drag.destroy(),h._animate.destroy(),h._animateChild.destroy(),Ct(h._visibilityQueue,!0,h),c._emit(M,{item:h,fromGrid:c,fromIndex:v,toGrid:t,toIndex:D}),t._emit(F,{item:h,fromGrid:c,fromIndex:v,toGrid:t,toIndex:D}),ft(f,g.itemClass),ft(f,g.itemVisibleClass),ft(f,g.itemHiddenClass),ht(f,p.itemClass),ht(f,u?p.itemVisibleClass:p.itemHiddenClass),c._items.splice(v,1),it(t._items,h,D),h._gridId=t._id,h._animate=new B.ItemAnimate(h,f),h._animateChild=new B.ItemAnimate(h,h._child),w!==(o=f.parentNode)&&(w.appendChild(f),s=_t(w,o,!0),l===i&&(l=st(f,"x"),d=st(f,"y")),dt(f,{transform:at(l+s.left,d+s.top)})),h._child.removeAttribute("style"),u?t._itemShowHandler.start(h,!0):t._itemHideHandler.start(h,!0),dt(f,{display:u?"block":"hidden"}),a=_t(w,y,!0),h._refreshDimensions()._refreshSortData(),h._drag=p.dragEnabled?new B.ItemDrag(h):null,r.isActive=!0,r.container=w,r.containerDiffX=a.left,r.containerDiffY=a.top,c._emit(T,{item:h,fromGrid:c,fromIndex:v,toGrid:t,toIndex:D}),t._emit(z,{item:h,fromGrid:c,fromIndex:v,toGrid:t,toIndex:D}),r)},W.prototype.stop=function(t,e){var i=this;if(i._isDestroyed||!i.isActive)return i;var n=i.getItem(),r=n._element,o=n.getGrid()._element;return i.container!==o&&(e||(e={transform:at(t?st(r,"x")-i.containerDiffX:n._left,t?st(r,"y")-i.containerDiffY:n._top)}),o.appendChild(r),dt(r,e)),i.isActive=!1,i.container=null,i.containerDiffX=0,i.containerDiffY=0,i},q.prototype.destroy=function(){return this._isDestroyed||(this.stop(!0),this._isDestroyed=!0),this},q.prototype.getItem=function(){return x[this._itemId]||null},q.prototype.reset=function(){var t=this;if(t._isDestroyed)return t;var e=t.getItem();return t.isActive=!1,t.isPositioningStarted=!1,t.containerDiffX=0,t.containerDiffY=0,ft(e._element,e.getGrid()._settings.itemReleasingClass),t},q.prototype.start=function(){var t=this;if(t._isDestroyed||t.isActive)return t;var e=t.getItem(),i=e.getGrid();return t.isActive=!0,ht(e._element,i._settings.itemReleasingClass),i._emit("dragReleaseStart",e),e._layout(!1),t},q.prototype.stop=function(t,e){var i=this;if(i._isDestroyed||!i.isActive)return i;var n=i.getItem(),r=n._element,o=n.getGrid(),s=o._element,a=i.containerDiffX,l=i.containerDiffY;return i.reset(),r.parentNode!==s&&(e||(e={transform:at(t?st(r,"x")-a:n._left,t?st(r,"y")-l:n._top)}),s.appendChild(r),dt(r,e)),t||o._emit("dragReleaseEnd",n),i},U.defaultStartPredicate=function(t,e,i){var n,r,s,a,d=t._element,h=t._drag._startPredicateData;if(h||(n=K(n=i||t._drag.getGrid()._settings.dragStartPredicate)?n:{},h=t._drag._startPredicateData={distance:l.abs(n.distance)||0,delay:l.max(n.delay,0)||0,handle:"string"==typeof n.handle&&n.handle}),e.isFinal)return r="a"===d.tagName.toLowerCase(),s=d.getAttribute("href"),a=d.getAttribute("target"),Ht(t),void(r&&s&&l.abs(e.deltaX)<2&&l.abs(e.deltaY)<2&&e.deltaTime<200&&(a&&"_self"!==a?o.open(s,a):o.location.href=s));if(!h.handleElement)if(h.handle){for(h.handleElement=(e.changedPointers[0]||{}).target;h.handleElement&&!R(h.handleElement,h.handle);)h.handleElement=h.handleElement!==d?h.handleElement.parentElement:null;if(!h.handleElement)return!1}else h.handleElement=d;return h.delay&&(h.event=e,h.delayTimer||(h.delayTimer=o.setTimeout(function(){h.delay=0,xt(t,h.event)&&(t._drag._resolveStartPredicate(h.event),Ht(t))},h.delay))),xt(t,e)},U.defaultSortPredicate=function(t){var e,i,n,r,o,s=t._drag,l=s._data,d=s.getGrid(),h=d._settings.dragSortPredicate||{},f=h.threshold||50,u=h.action||"move",_={width:t._width,height:t._height,left:l.elementClientX,top:l.elementClientY},c=function(t,e,i,n){var r,o,s,l=null,d=e._settings.dragSort,h=!0===d?[e]:d.call(e,t),f=-1;if(!a.isArray(h))return l;for(s=0;s<h.length;s++)(o=h[s])._isDestroyed||(o._refreshDimensions(),(r=vt(i,{width:o._width,height:o._height,left:o._left,top:o._top}))>n&&r>f&&(f=r,l=o));return l}(t,d,_,f),g=0,m=0,p=-1;if(!c)return!1;for(c===d?(_.left=l.gridX+t._margin.left,_.top=l.gridY+t._margin.top):(g=c._left+c._border.left,m=c._top+c._border.top),o=0;o<c._items.length;o++)(n=c._items[o])._isActive&&n!==t&&(i=!0,(r=vt(_,{width:n._width,height:n._height,left:n._left+n._margin.left+g,top:n._top+n._margin.top+m}))>p&&(e=o,p=r));return p<f&&t.getGrid()!==c&&(e=i?-1:0,p=1/0),p>=f&&{grid:c,index:e,action:u}},U.prototype.destroy=function(){var t=this;return t._isDestroyed||(t.stop(),t._hammer.destroy(),t.getItem()._element.removeEventListener("dragstart",At,!1),t._isDestroyed=!0),t},U.prototype.getItem=function(){return x[this._itemId]||null},U.prototype.getGrid=function(){return A[this._gridId]||null},U.prototype.reset=function(){var t=this._data;return t.isActive=!1,t.container=null,t.containingBlock=null,t.startEvent=null,t.currentEvent=null,t.scrollers=[],t.left=0,t.top=0,t.gridX=0,t.gridY=0,t.elementClientX=0,t.elementClientY=0,t.containerDiffX=0,t.containerDiffY=0,this},U.prototype.bindScrollListeners=function(){var t,e=this,i=e.getGrid()._element,n=e._data.container,r=mt(e.getItem()._element);for(n!==i&&(r=function(t){var e,i=[],n=t.length;if(n)for(i[0]=t[0],e=1;e<n;e++)i.indexOf(t[e])<0&&i.push(t[e]);return i}(r.concat(i).concat(mt(i)))),t=0;t<r.length;t++)r[t].addEventListener("scroll",e._scrollListener);return e._data.scrollers=r,e},U.prototype.unbindScrollListeners=function(){var t,e=this._data,i=e.scrollers;for(t=0;t<i.length;t++)i[t].removeEventListener("scroll",this._scrollListener);return e.scrollers=[],this},U.prototype.checkOverlap=function(){var t,e,i,n,r,o,s=this,a=s.getItem(),l=s._sortPredicate(a,s._data.currentEvent);return K(l)&&typeof l.index===m?(o=(t=a.getGrid())!==(i=l.grid||t),e=t._items.indexOf(a),n=Z(i._items,l.index,o),r="swap"===l.action?"swap":"move",o?(t._emit(M,{item:a,fromGrid:t,fromIndex:e,toGrid:i,toIndex:n}),i._emit(F,{item:a,fromGrid:t,fromIndex:e,toGrid:i,toIndex:n}),a._gridId=i._id,s._isMigrating=a._gridId!==s._gridId,t._items.splice(e,1),it(i._items,a,n),a._sortData=null,t._emit(T,{item:a,fromGrid:t,fromIndex:e,toGrid:i,toIndex:n}),i._emit(z,{item:a,fromGrid:t,fromIndex:e,toGrid:i,toIndex:n}),t.layout(),i.layout()):e!==n&&(("swap"===r?$:J)(t._items,e,n),t._emit(k,{item:a,fromIndex:e,toIndex:n,action:r}),t.layout()),s):s},U.prototype.finishMigration=function(){var t,e,i,n=this,r=n.getItem(),o=r._release,s=r._element,a=r.getGrid(),l=a._element,d=a._settings,h=d.dragContainer||l,f=n.getGrid()._settings,u=s.parentNode;return n._isMigrating=!1,n.destroy(),r._animate.destroy(),r._animateChild.destroy(),ft(s,f.itemClass),ft(s,f.itemVisibleClass),ft(s,f.itemHiddenClass),ht(s,d.itemClass),ht(s,d.itemVisibleClass),r._animate=new B.ItemAnimate(r,s),r._animateChild=new B.ItemAnimate(r,r._child),h!==u&&(h.appendChild(s),i=_t(u,h,!0),t=st(s,"x")-i.left,e=st(s,"y")-i.top),r._refreshDimensions()._refreshSortData(),i=_t(h,l,!0),o.containerDiffX=i.left,o.containerDiffY=i.top,r._drag=d.dragEnabled?new B.ItemDrag(r):null,h!==u&&dt(s,{transform:at(t,e)}),r._child.removeAttribute("style"),a._itemShowHandler.start(r,!0),o.start(),n},U.prototype.cancelRafLoop=function(){var t=this.getItem()._id;return p.cancel(w,t),p.cancel(D,t),this},U.prototype.stop=function(){var t=this,e=t._data,i=t.getItem()._element,n=t.getGrid();return e.isActive?t._isMigrating?t.finishMigration(e.currentEvent):(t.cancelRafLoop(),t.unbindScrollListeners(),t._checkSortOverlap("cancel"),i.parentNode!==n._element&&(n._element.appendChild(i),dt(i,{transform:at(e.gridX,e.gridY)})),ft(i,n._settings.itemDraggingClass),t.reset(),t):t},U.prototype.onStart=function(t){var e=this,i=e.getItem();if(!i._isActive)return e;var n,r=i._element,o=e.getGrid(),s=o._settings,a=e._data,l=i._release,d=i._migrate,h=o._element,f=s.dragContainer||h,u=gt(f,!0),_=st(r,"x"),c=st(r,"y"),g=r.getBoundingClientRect(),m=f!==h;return m&&(n=_t(u,h)),i.isPositioning()&&i._stopLayout(!0,{transform:at(_,c)}),d.isActive&&(_-=d.containerDiffX,c-=d.containerDiffY,d.stop(!0,{transform:at(_,c)})),i.isReleasing()&&l.reset(),a.isActive=!0,a.startEvent=a.currentEvent=t,a.container=f,a.containingBlock=u,a.elementClientX=g.left,a.elementClientY=g.top,a.left=a.gridX=_,a.top=a.gridY=c,o._emit("dragInit",i,t),m&&(a.containerDiffX=n.left,a.containerDiffY=n.top,r.parentNode===f?(a.gridX=_-a.containerDiffX,a.gridY=c-a.containerDiffY):(a.left=_+a.containerDiffX,a.top=c+a.containerDiffY,f.appendChild(r),dt(r,{transform:at(a.left,a.top)}))),ht(r,s.itemDraggingClass),e.bindScrollListeners(),o._emit("dragStart",i,t),e},U.prototype.onMove=function(t){var e=this,i=e.getItem();if(!i._isActive)return e.stop();var n=i._element,r=e.getGrid(),o=r._settings,s=e._data,a=o.dragAxis,l=t.deltaX-s.currentEvent.deltaX,d=t.deltaY-s.currentEvent.deltaY;return p.add(D,i._id,function(){s.currentEvent=t,"y"!==a&&(s.left+=l,s.gridX+=l,s.elementClientX+=l),"x"!==a&&(s.top+=d,s.gridY+=d,s.elementClientY+=d),o.dragSort&&e._checkSortOverlap()},function(){dt(n,{transform:at(s.left,s.top)}),r._emit("dragMove",i,t)}),e},U.prototype.onScroll=function(t){var e,i,n,r,o=this,s=o.getItem(),a=s._element,l=o.getGrid(),d=l._settings,h=d.dragAxis,f=o._data,u=l._element;return p.add(w,s._id,function(){e=a.getBoundingClientRect(),i=f.elementClientX-e.left,n=f.elementClientY-e.top,f.container!==u&&(r=_t(f.containingBlock,u),f.containerDiffX=r.left,f.containerDiffY=r.top),"y"!==h&&(f.left+=i,f.gridX=f.left-f.containerDiffX),"x"!==h&&(f.top+=n,f.gridY=f.top-f.containerDiffY),d.dragSort&&o._checkSortOverlap()},function(){dt(a,{transform:at(f.left,f.top)}),l._emit("dragScroll",s,t)}),o},U.prototype.onEnd=function(t){var e=this,i=e.getItem(),n=i._element,r=e.getGrid(),o=r._settings,s=e._data,a=i._release;return i._isActive?(e.cancelRafLoop(),o.dragSort&&e._checkSortOverlap("finish"),e.unbindScrollListeners(),a.containerDiffX=s.containerDiffX,a.containerDiffY=s.containerDiffY,e.reset(),ft(n,o.itemDraggingClass),r._emit("dragEnd",i,t),e._isMigrating?e.finishMigration():a.start(),e):e.stop()},Et.getSlot=function(t,e,i,n,r,o){var s,a,l,d,h,f=[],u={left:null,top:null,width:i,height:n};for(d=0;d<e.length;d++)if(s=e[d],u.width<=s.width+.001&&u.height<=s.height+.001){u.left=s.left,u.top=s.top;break}for(null===u.left&&(u.left=r?0:t.width,u.top=r?t.height:0,o||(l=!0)),r&&u.top+u.height>t.height&&(u.left>0&&f.push({left:0,top:t.height,width:u.left,height:1/0}),u.left+u.width<t.width&&f.push({left:u.left+u.width,top:t.height,width:t.width-u.left-u.width,height:1/0}),t.height=u.top+u.height),!r&&u.left+u.width>t.width&&(u.top>0&&f.push({left:t.width,top:0,width:1/0,height:u.top}),u.top+u.height<t.height&&f.push({left:t.width,top:u.top+u.height,width:1/0,height:t.height-u.top-u.height}),t.width=u.left+u.width),d=o?0:l?e.length:d;d<e.length;d++)for(a=Et.splitRect(e[d],u),h=0;h<a.length;h++)(s=a[h]).width>.49&&s.height>.49&&(r&&s.top<t.height||!r&&s.left<t.width)&&f.push(s);return f.length&&(f=Et.purgeRects(f).sort(r?Et.sortRectsTopLeft:Et.sortRectsLeftTop)),[u,f]},Et.splitRect=function(t,e){var i=[];return Et.doRectsOverlap(t,e)?(t.left<e.left&&i.push({left:t.left,top:t.top,width:e.left-t.left,height:t.height}),t.left+t.width>e.left+e.width&&i.push({left:e.left+e.width,top:t.top,width:t.left+t.width-(e.left+e.width),height:t.height}),t.top<e.top&&i.push({left:t.left,top:t.top,width:t.width,height:e.top-t.top}),t.top+t.height>e.top+e.height&&i.push({left:t.left,top:e.top+e.height,width:t.width,height:t.top+t.height-(e.top+e.height)}),i):[{left:t.left,top:t.top,width:t.width,height:t.height}]},Et.doRectsOverlap=function(t,e){return!(t.left+t.width<=e.left||e.left+e.width<=t.left||t.top+t.height<=e.top||e.top+e.height<=t.top)},Et.isRectWithinRect=function(t,e){return t.left>=e.left&&t.top>=e.top&&t.left+t.width<=e.left+e.width&&t.top+t.height<=e.top+e.height},Et.purgeRects=function(t){for(var e,i,n,r=t.length;r--;)for(i=t[r],e=t.length;e--;)if(n=t[e],r!==e&&Et.isRectWithinRect(i,n)){t.splice(r,1);break}return t},Et.sortRectsTopLeft=function(t,e){return t.top-e.top||t.left-e.left},Et.sortRectsLeftTop=function(t,e){return t.left-e.left||t.top-e.top},B});